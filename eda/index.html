
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../dashboard/">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/git-wpsilva/5DataGlowUp/main/img/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>Análise Exploratória - Projeto Airbnb 🏠</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#eda-analise-exploratoria-dos-dados" class="md-skip">
          Ir para o conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href=".." title="Projeto Airbnb 🏠" class="md-header__button md-logo" aria-label="Projeto Airbnb 🏠" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/git-wpsilva/5DataGlowUp/main/img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Projeto Airbnb 🏠
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Análise Exploratória
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Tema Escuro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Tema Escuro" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Tema Escuro"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Tema Escuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando a pesquisa
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/git-wpsilva/5DataGlowUp" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    git-wpsilva/5DataGlowUp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Abas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Análise Exploratória

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../dashboard/" class="md-tabs__link">
        
  
    
  
  Dashboard

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Projeto Airbnb 🏠" class="md-nav__button md-logo" aria-label="Projeto Airbnb 🏠" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/git-wpsilva/5DataGlowUp/main/img/logo.png" alt="logo">

    </a>
    Projeto Airbnb 🏠
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/git-wpsilva/5DataGlowUp" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    git-wpsilva/5DataGlowUp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Análise Exploratória
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Análise Exploratória
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#carregando-as-bibliotecas" class="md-nav__link">
    <span class="md-ellipsis">
      Carregando as Bibliotecas 📚
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lendo-os-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Lendo os dados 👀
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lendo os dados 👀">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dados-dos-imoveis" class="md-nav__link">
    <span class="md-ellipsis">
      Dados dos imóveis 🏠
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dados-das-reviews" class="md-nav__link">
    <span class="md-ellipsis">
      Dados das reviews ⭐
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analise-exploratoria-dos-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Análise Exploratória dos Dados 🔎
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análise Exploratória dos Dados 🔎">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proporcao-das-colunas-e-linhas" class="md-nav__link">
    <span class="md-ellipsis">
      Proporção das colunas e linhas 📋
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observando-o-tipo-das-variaveis" class="md-nav__link">
    <span class="md-ellipsis">
      Observando o Tipo das Variáveis 🔢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificando-se-ha-valores-nulos" class="md-nav__link">
    <span class="md-ellipsis">
      Verificando se há Valores Nulos ❌
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excluindo-colunas-desnecessarias" class="md-nav__link">
    <span class="md-ellipsis">
      Excluindo Colunas Desnecessárias 🧹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificando-dados-duplicados" class="md-nav__link">
    <span class="md-ellipsis">
      Verificando dados duplicados 🎌
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajustando-valores-dos-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Ajustando Valores dos Dados 📏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analises-graficas" class="md-nav__link">
    <span class="md-ellipsis">
      Análises Gráficas 📈
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análises Gráficas 📈">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grafico-de-distribuicao" class="md-nav__link">
    <span class="md-ellipsis">
      Gráfico de Distribuição 📊
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grafico-de-dispersao" class="md-nav__link">
    <span class="md-ellipsis">
      Gráfico de Dispersão 👨🏽‍👨🏽‍👦🏽‍👧🏽
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapa-de-calor" class="md-nav__link">
    <span class="md-ellipsis">
      Mapa de Calor 🔥🗺️
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definindo-um-score" class="md-nav__link">
    <span class="md-ellipsis">
      Definindo um Score 🥇
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#salvando-os-resultados" class="md-nav__link">
    <span class="md-ellipsis">
      Salvando os Resultados 💾
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../dashboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dashboard
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#carregando-as-bibliotecas" class="md-nav__link">
    <span class="md-ellipsis">
      Carregando as Bibliotecas 📚
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lendo-os-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Lendo os dados 👀
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lendo os dados 👀">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dados-dos-imoveis" class="md-nav__link">
    <span class="md-ellipsis">
      Dados dos imóveis 🏠
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dados-das-reviews" class="md-nav__link">
    <span class="md-ellipsis">
      Dados das reviews ⭐
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analise-exploratoria-dos-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Análise Exploratória dos Dados 🔎
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análise Exploratória dos Dados 🔎">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proporcao-das-colunas-e-linhas" class="md-nav__link">
    <span class="md-ellipsis">
      Proporção das colunas e linhas 📋
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observando-o-tipo-das-variaveis" class="md-nav__link">
    <span class="md-ellipsis">
      Observando o Tipo das Variáveis 🔢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificando-se-ha-valores-nulos" class="md-nav__link">
    <span class="md-ellipsis">
      Verificando se há Valores Nulos ❌
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excluindo-colunas-desnecessarias" class="md-nav__link">
    <span class="md-ellipsis">
      Excluindo Colunas Desnecessárias 🧹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verificando-dados-duplicados" class="md-nav__link">
    <span class="md-ellipsis">
      Verificando dados duplicados 🎌
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajustando-valores-dos-dados" class="md-nav__link">
    <span class="md-ellipsis">
      Ajustando Valores dos Dados 📏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analises-graficas" class="md-nav__link">
    <span class="md-ellipsis">
      Análises Gráficas 📈
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análises Gráficas 📈">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grafico-de-distribuicao" class="md-nav__link">
    <span class="md-ellipsis">
      Gráfico de Distribuição 📊
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grafico-de-dispersao" class="md-nav__link">
    <span class="md-ellipsis">
      Gráfico de Dispersão 👨🏽‍👨🏽‍👦🏽‍👧🏽
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapa-de-calor" class="md-nav__link">
    <span class="md-ellipsis">
      Mapa de Calor 🔥🗺️
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definindo-um-score" class="md-nav__link">
    <span class="md-ellipsis">
      Definindo um Score 🥇
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#salvando-os-resultados" class="md-nav__link">
    <span class="md-ellipsis">
      Salvando os Resultados 💾
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<style>
  div.md-sidebar.md-sidebar--primary {
    display: none !important;
  }
  .md-grid {
  max-width: 100%; /* or 100%, if you want to stretch to full-width */
}
</style>

<h1 id="eda-analise-exploratoria-dos-dados">EDA: Análise Exploratória dos Dados</h1>
<h2 id="carregando-as-bibliotecas">Carregando as Bibliotecas 📚</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span> <span class="nn">forex_python.converter</span> <span class="kn">import</span> <span class="n">CurrencyRates</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</span></code></pre></div>
<h2 id="lendo-os-dados">Lendo os dados 👀</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">arquivo</span> <span class="o">=</span> <span class="s1">&#39;data/input/Listings.csv&#39;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">arq_rev</span> <span class="o">=</span> <span class="s1">&#39;data/input/Reviews.csv&#39;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">arquivo_dic</span> <span class="o">=</span> <span class="s1">&#39;data/input/Listings_data_dictionary.csv&#39;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">arq_dic</span> <span class="o">=</span> <span class="s1">&#39;data/input/Reviews_data_dictionary.csv&#39;</span> 
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Para você replicar estes códigos será necessário baixar as fontes de dados <a href="https://drive.google.com/drive/folders/1UVEfA673UWxLGnV0Xwg7TdJj-Hc4YH37?usp=sharing">aqui</a> e carregá-las nesta etapa de leitura.</p>
</div>
<h3 id="dados-dos-imoveis">Dados dos imóveis 🏠</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">df_arquivo_dic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arquivo_dic</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">df_arquivo_dic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>listing_id</td>
      <td>Listing ID</td>
    </tr>
    <tr>
      <th>1</th>
      <td>name</td>
      <td>Listing Name</td>
    </tr>
    <tr>
      <th>2</th>
      <td>host_id</td>
      <td>Host ID</td>
    </tr>
    <tr>
      <th>3</th>
      <td>host_since</td>
      <td>Date the Host joined Airbnb</td>
    </tr>
    <tr>
      <th>4</th>
      <td>host_location</td>
      <td>Location where the Host is based</td>
    </tr>
    <tr>
      <th>5</th>
      <td>host_response_time</td>
      <td>Estimate of how long the Host takes to respond</td>
    </tr>
    <tr>
      <th>6</th>
      <td>host_response_rate</td>
      <td>Percentage of times the Host responds</td>
    </tr>
    <tr>
      <th>7</th>
      <td>host_acceptance_rate</td>
      <td>Percentage of times the Host accepts a booking...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>host_is_superhost</td>
      <td>Binary field to determine if the Host is a Sup...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>host_total_listings_count</td>
      <td>Total listings the Host has in Airbnb</td>
    </tr>
    <tr>
      <th>10</th>
      <td>host_has_profile_pic</td>
      <td>Binary field to determine if the Host has a pr...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>host_identity_verified</td>
      <td>Binary field to determine if the Host has a ve...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>neighbourhood</td>
      <td>Neighborhood the Listing is in</td>
    </tr>
    <tr>
      <th>13</th>
      <td>district</td>
      <td>District the Listing is in</td>
    </tr>
    <tr>
      <th>14</th>
      <td>city</td>
      <td>City the Listing is in</td>
    </tr>
    <tr>
      <th>15</th>
      <td>latitude</td>
      <td>Listing's latitude</td>
    </tr>
    <tr>
      <th>16</th>
      <td>longitude</td>
      <td>Listing's longitude</td>
    </tr>
    <tr>
      <th>17</th>
      <td>property_type</td>
      <td>Type of property for the Listing</td>
    </tr>
    <tr>
      <th>18</th>
      <td>room_type</td>
      <td>Type of room type in Airbnb for the Listing</td>
    </tr>
    <tr>
      <th>19</th>
      <td>accommodates</td>
      <td>Guests the Listing accomodates</td>
    </tr>
    <tr>
      <th>20</th>
      <td>bedrooms</td>
      <td>Bedrooms in the Listing</td>
    </tr>
    <tr>
      <th>21</th>
      <td>amenities</td>
      <td>Amenities the Listing includes</td>
    </tr>
    <tr>
      <th>22</th>
      <td>price</td>
      <td>Listing price (in each country's currency)</td>
    </tr>
    <tr>
      <th>23</th>
      <td>minimum_nights</td>
      <td>Minimum nights per booking</td>
    </tr>
    <tr>
      <th>24</th>
      <td>maximum_nights</td>
      <td>Maximum nights per booking</td>
    </tr>
    <tr>
      <th>25</th>
      <td>review_scores_rating</td>
      <td>Listing's overall rating (out of 100)</td>
    </tr>
    <tr>
      <th>26</th>
      <td>review_scores_accuracy</td>
      <td>Listing's accuracy score based on what's promo...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>review_scores_cleanliness</td>
      <td>Listing's cleanliness score (out of 10)</td>
    </tr>
    <tr>
      <th>28</th>
      <td>review_scores_checkin</td>
      <td>Listing's check-in experience score (out of 10)</td>
    </tr>
    <tr>
      <th>29</th>
      <td>review_scores_communication</td>
      <td>Listing's communication with the Host score (o...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>review_scores_location</td>
      <td>Listing's location score within the city (out ...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>review_scores_value</td>
      <td>Listing's value score relative to its price (o...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>instant_bookable</td>
      <td>Binary field to determine if the Listing can b...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Se tentarmos ler os arquivos dos imóveis sem configurar um enconding apropriado vamos obter um erro:</p>
<div class="admonition failure">
<p class="admonition-title">Erro</p>
<p>'utf-8' codec can't decode byte 0x81 in position 206899: invalid start byte</p>
</div>
<p>Usando o encode <em>'iso-8859-1'</em> encontra-se trechos, principalmente olhando na varíavel 'name', com caracteres especiais como '', eu busquei encontrar um padrão nos caracteres especiais para preencher os trechos incorretos da forma correta, mas esse padrão alterava na medida que o idioma mudava, felizmente vi uma <a href="https://www.linkedin.com/posts/lucianovasconcelosf_recebi-uma-mensagem-do-desafio-do-heitor-activity-7118561545864830978-7cwT?utm_source=share&amp;utm_medium=member_desktop">postagem</a> do <a href="https://www.linkedin.com/in/lucianovasconcelosf/">Luciano Vasconcelos</a> resolvendo este problema com uma abordagem mais eficiente, onde ele corrigia os problemas com o encoding, eliminando o mal pela raiz.</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Função para corrigir a codificação de uma string</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">def</span> <span class="nf">fix_encoding</span><span class="p">(</span><span class="n">problem_string</span><span class="p">):</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">problem_string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>        <span class="k">return</span> <span class="n">problem_string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Windows-1252&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>        <span class="k">return</span> <span class="n">problem_string</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># Lendo o arquivo com codificação UTF-8</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arquivo</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c1"># Aplicando a correção de codificação na coluna &#39;Name&#39;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fix_encoding</span><span class="p">)</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c1"># Salvando o arquivo corrigido com codificação UTF-8</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/output/Listings_new.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/output/Listings_new.csv&#39;</span><span class="p">)</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listing_id</th>
      <th>name</th>
      <th>host_id</th>
      <th>host_since</th>
      <th>host_location</th>
      <th>host_response_time</th>
      <th>host_response_rate</th>
      <th>host_acceptance_rate</th>
      <th>host_is_superhost</th>
      <th>host_total_listings_count</th>
      <th>host_has_profile_pic</th>
      <th>host_identity_verified</th>
      <th>neighbourhood</th>
      <th>district</th>
      <th>city</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>property_type</th>
      <th>room_type</th>
      <th>accommodates</th>
      <th>bedrooms</th>
      <th>amenities</th>
      <th>price</th>
      <th>minimum_nights</th>
      <th>maximum_nights</th>
      <th>review_scores_rating</th>
      <th>review_scores_accuracy</th>
      <th>review_scores_cleanliness</th>
      <th>review_scores_checkin</th>
      <th>review_scores_communication</th>
      <th>review_scores_location</th>
      <th>review_scores_value</th>
      <th>instant_bookable</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>281420</td>
      <td>Beautiful Flat in le Village Montmartre, Paris</td>
      <td>1466919</td>
      <td>2011-12-03</td>
      <td>Paris, Ile-de-France, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f</td>
      <td>1.0</td>
      <td>t</td>
      <td>f</td>
      <td>Buttes-Montmartre</td>
      <td>NaN</td>
      <td>Paris</td>
      <td>48.88668</td>
      <td>2.33343</td>
      <td>Entire apartment</td>
      <td>Entire place</td>
      <td>2</td>
      <td>1.0</td>
      <td>["Heating", "Kitchen", "Washer", "Wifi", "Long...</td>
      <td>53</td>
      <td>2</td>
      <td>1125</td>
      <td>100.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>f</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3705183</td>
      <td>39 m² Paris (Sacre Cœur)</td>
      <td>10328771</td>
      <td>2013-11-29</td>
      <td>Paris, Ile-de-France, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f</td>
      <td>1.0</td>
      <td>t</td>
      <td>t</td>
      <td>Buttes-Montmartre</td>
      <td>NaN</td>
      <td>Paris</td>
      <td>48.88617</td>
      <td>2.34515</td>
      <td>Entire apartment</td>
      <td>Entire place</td>
      <td>2</td>
      <td>1.0</td>
      <td>["Shampoo", "Heating", "Kitchen", "Essentials"...</td>
      <td>120</td>
      <td>2</td>
      <td>1125</td>
      <td>100.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>f</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4082273</td>
      <td>Lovely apartment with Terrace, 60m2</td>
      <td>19252768</td>
      <td>2014-07-31</td>
      <td>Paris, Ile-de-France, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f</td>
      <td>1.0</td>
      <td>t</td>
      <td>f</td>
      <td>Elysee</td>
      <td>NaN</td>
      <td>Paris</td>
      <td>48.88112</td>
      <td>2.31712</td>
      <td>Entire apartment</td>
      <td>Entire place</td>
      <td>2</td>
      <td>1.0</td>
      <td>["Heating", "TV", "Kitchen", "Washer", "Wifi",...</td>
      <td>89</td>
      <td>2</td>
      <td>1125</td>
      <td>100.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>f</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4797344</td>
      <td>Cosy studio (close to Eiffel tower)</td>
      <td>10668311</td>
      <td>2013-12-17</td>
      <td>Paris, Ile-de-France, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f</td>
      <td>1.0</td>
      <td>t</td>
      <td>t</td>
      <td>Vaugirard</td>
      <td>NaN</td>
      <td>Paris</td>
      <td>48.84571</td>
      <td>2.30584</td>
      <td>Entire apartment</td>
      <td>Entire place</td>
      <td>2</td>
      <td>1.0</td>
      <td>["Heating", "TV", "Kitchen", "Wifi", "Long ter...</td>
      <td>58</td>
      <td>2</td>
      <td>1125</td>
      <td>100.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>f</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4823489</td>
      <td>Close to Eiffel Tower - Beautiful flat : 2 rooms</td>
      <td>24837558</td>
      <td>2014-12-14</td>
      <td>Paris, Ile-de-France, France</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f</td>
      <td>1.0</td>
      <td>t</td>
      <td>f</td>
      <td>Passy</td>
      <td>NaN</td>
      <td>Paris</td>
      <td>48.85500</td>
      <td>2.26979</td>
      <td>Entire apartment</td>
      <td>Entire place</td>
      <td>2</td>
      <td>1.0</td>
      <td>["Heating", "TV", "Kitchen", "Essentials", "Ha...</td>
      <td>60</td>
      <td>2</td>
      <td>1125</td>
      <td>100.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>f</td>
    </tr>
  </tbody>
</table>
</div>

<p>Como já podemos observar acima, os caracteres especiais estão corretos, para validação, eu filtrei trechos que contém outros idiomas, fui alterando o nome do país e rodando o script novamente, como consulta deixo o último país que verifiquei, a Tailândia, lembrando que o objetivo não era traduzir o alfabeto tailandês para o alfabeto romano, o idioma dos nomes permecerá conforme foram registrados.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;host_location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Thailand&#39;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>12016                        Belleville Serviced Apartment
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>12017                           Studio with Private Garden
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>12126                  Simply space but extraordinary rest
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>12128                        1BR INFINITY POOL HIPSTERHOOD
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>12239                     Modern/Cozy 1BR Apt downtown BKK
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>12241    1BR Rooftop Garden+Gym+Pool Bangkok, 2 mins to...
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>12242    356 D CondoSathu49, Bangkok (Rama3-Sathorn-Non...
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>12433                  cozy &amp; great location 350m.from MRT
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>12434                                 Metro luxe kasetsart
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>12574                简风格两居室近MRT/10分钟到达大皇宫/4个人/无边泳池/新房/供接机务
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>12699     1BR with big balcony by the river, near IconSiam
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>12759                       New Residence (นิว เรสซิเดนซ์)
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>12855        Cozy apartment, Saphan Taksin BTS &amp; Boat pier
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>13065            Sitara Place Serviced Apartment and Hotel
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>13066                                New Room-5mins to MRT
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>Name: name, dtype: object
</span></code></pre></div></p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
</span></code></pre></div>
Busquei por linhas que continham o caractere '' no meio das palavras e não foi encontrado nenhuma linha.</p>
<h3 id="dados-das-reviews">Dados das reviews ⭐</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">df_arq_dic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arq_dic</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">df_arq_dic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>listing_id</td>
      <td>Listing ID</td>
    </tr>
    <tr>
      <th>1</th>
      <td>review_id</td>
      <td>Review ID</td>
    </tr>
    <tr>
      <th>2</th>
      <td>date</td>
      <td>Review date</td>
    </tr>
    <tr>
      <th>3</th>
      <td>reviewer_id</td>
      <td>Reviewer ID</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-py highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">df_rev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arq_rev</span><span class="p">)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">df_rev</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listing_id</th>
      <th>review_id</th>
      <th>date</th>
      <th>reviewer_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11798</td>
      <td>330265172</td>
      <td>2018-09-30</td>
      <td>11863072</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15383</td>
      <td>330103585</td>
      <td>2018-09-30</td>
      <td>39147453</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16455</td>
      <td>329985788</td>
      <td>2018-09-30</td>
      <td>1125378</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17919</td>
      <td>330016899</td>
      <td>2018-09-30</td>
      <td>172717984</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26827</td>
      <td>329995638</td>
      <td>2018-09-30</td>
      <td>17542859</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="analise-exploratoria-dos-dados">Análise Exploratória dos Dados 🔎</h2>
<h3 id="proporcao-das-colunas-e-linhas">Proporção das colunas e linhas 📋</h3>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Imóveis 🏠 &#39;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reviews ⭐ &#39;</span><span class="p">,</span><span class="n">df_rev</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Imóveis 🏠  (279712, 33)
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>Reviews ⭐  (5373143, 4)
</span></code></pre></div></p>
<h3 id="observando-o-tipo-das-variaveis">Observando o Tipo das Variáveis 🔢</h3>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Imóveis 🏠 </span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>listing_id                       int64
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>name                            object
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>host_id                          int64
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>host_since                      object
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>host_location                   object
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>host_response_time              object
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>host_response_rate             float64
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>host_acceptance_rate           float64
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>host_is_superhost               object
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>host_total_listings_count      float64
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>host_has_profile_pic            object
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>host_identity_verified          object
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>neighbourhood                   object
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>district                        object
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>city                            object
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>latitude                       float64
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>longitude                      float64
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>property_type                   object
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>room_type                       object
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>accommodates                     int64
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>bedrooms                       float64
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>amenities                       object
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>price                            int64
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>minimum_nights                   int64
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>maximum_nights                   int64
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>review_scores_rating           float64
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>review_scores_accuracy         float64
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>review_scores_cleanliness      float64
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>review_scores_checkin          float64
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>review_scores_communication    float64
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>review_scores_location         float64
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>review_scores_value            float64
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>instant_bookable                object
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>dtype: object
</span></code></pre></div></p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Reviews ⭐</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">df_rev</span><span class="o">.</span><span class="n">dtypes</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>listing_id      int64
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>review_id       int64
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>date           object
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>reviewer_id     int64
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>dtype: object
</span></code></pre></div></p>
<h3 id="verificando-se-ha-valores-nulos">Verificando se há Valores Nulos ❌</h3>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Imóveis 🏠 </span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">faltantes</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;listing_id&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">faltantes</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>listing_id                      0.000000
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>name                            0.062564
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>host_id                         0.000000
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>host_since                      0.058989
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>host_location                   0.300309
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>host_response_time             46.040928
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>host_response_rate             46.040928
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>host_acceptance_rate           40.429799
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>host_is_superhost               0.058989
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>host_total_listings_count       0.058989
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>host_has_profile_pic            0.058989
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>host_identity_verified          0.058989
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>neighbourhood                   0.000000
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>district                       86.767818
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>city                            0.000000
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>latitude                        0.000000
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>longitude                       0.000000
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>property_type                   0.000000
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>room_type                       0.000000
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>accommodates                    0.000000
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>bedrooms                       10.523324
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>amenities                       0.000000
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>price                           0.000000
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>minimum_nights                  0.000000
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>maximum_nights                  0.000000
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>review_scores_rating           32.678255
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>review_scores_accuracy         32.788368
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>review_scores_cleanliness      32.771208
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>review_scores_checkin          32.809104
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>review_scores_communication    32.779073
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>review_scores_location         32.810534
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>review_scores_value            32.814109
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>instant_bookable                0.000000
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>dtype: float64
</span></code></pre></div></p>
<p>Lidar com dados faltantes é algo que abre bastante discussões sobre abordagem, um caso óbvio, como a varável <em>'district'</em>, que contém 87% dos dados vazios, excluirei a coluna inteira.
Outras colunas, como a <em>'host_identity_verified'</em>, possui 0,05% de linhas vazias, onde poderia pensar em manter essas linhas nulas, excluir apenas elas ou preenchê-las com valores, caso fosse apropriado. </p>
<p>Porém, como o objetivo da minha abordagem é trazer um panorama dos imóveis, essa e outras colunas são desnecessárias, excluí-la-eis.</p>
<p>Como nem tudo é perfeito, temos algumas colunas importantes para nossa análise sobre os imóveis que possuem linhas nulas, que são as reviews, mas um imóvel que tem sua linha de review vazia, não teve review. Para simbolizar a falta de review vou atribuir o número zero para essas colunas. </p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Reviews que contém valores nulos</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">rev_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="s1">&#39;review_scores_rating&#39;</span><span class="p">,</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="s1">&#39;review_scores_accuracy&#39;</span><span class="p">,</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="s1">&#39;review_scores_cleanliness&#39;</span><span class="p">,</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="s1">&#39;review_scores_checkin&#39;</span><span class="p">,</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="s1">&#39;review_scores_communication&#39;</span><span class="p">,</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="s1">&#39;review_scores_location&#39;</span><span class="p">,</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="s1">&#39;review_scores_value&#39;</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="p">]</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="c1"># Preenchendo as colunas com valores nulos com 0</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">df</span><span class="p">[</span><span class="n">rev_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">rev_columns</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition question">
<p class="admonition-title">Pergunta</p>
<p>Como separar quem não teve review com quem teve uma review como de fato sendo nota 0? </p>
</div>
<p>Simples, vou contar o número de reviews que cada imóvel teve na base de reviews, aquela com 5 milhões de linhas, e adicionar esta coluna no dataset dos imóveis.</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Contar a frequência de cada ID</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">qty_reviews</span> <span class="o">=</span> <span class="n">df_rev</span><span class="p">[</span><span class="s1">&#39;listing_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># Renomeando as colunas</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">qty_reviews</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;listing_id&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="n">qty_reviews</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listing_id</th>
      <th>qty_reviews</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17222007</td>
      <td>891</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8637229</td>
      <td>828</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1249964</td>
      <td>796</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32011332</td>
      <td>762</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2399029</td>
      <td>754</td>
    </tr>
  </tbody>
</table>
</div>

<p>Agora é só adicionar essa coluna no nosso dataset de imóveis, se tivéssemos no <strong>Excel</strong>, era um <em>PROCV</em>, no <strong>SQL</strong> um <em>LEFT JOIN</em>, mas no <strong>Python</strong> utilizaremos o método <em>merge</em>:</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">merge_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">qty_reviews</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;listing_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Caso não haja reviews, preencha com 0</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div>
Só para não passar batido, vamos verificar se no dataset das reviews possuem valores vazios:</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Reviews ⭐</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">faltantes</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_rev</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_rev</span><span class="p">[</span><span class="s1">&#39;listing_id&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">faltantes</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>listing_id     0.0
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>review_id      0.0
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>date           0.0
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>reviewer_id    0.0
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>dtype: float64
</span></code></pre></div></p>
<h3 id="excluindo-colunas-desnecessarias">Excluindo Colunas Desnecessárias 🧹</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">drop_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="s1">&#39;host_since&#39;</span><span class="p">,</span>                      
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="s1">&#39;host_location&#39;</span><span class="p">,</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="s1">&#39;host_response_time&#39;</span><span class="p">,</span> 
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="s1">&#39;host_response_rate&#39;</span><span class="p">,</span>    
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="s1">&#39;host_acceptance_rate&#39;</span><span class="p">,</span> 
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="s1">&#39;host_is_superhost&#39;</span><span class="p">,</span> 
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="s1">&#39;host_total_listings_count&#39;</span><span class="p">,</span>  
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="s1">&#39;host_has_profile_pic&#39;</span><span class="p">,</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="s1">&#39;host_identity_verified&#39;</span><span class="p">,</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="s1">&#39;district&#39;</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="p">]</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="n">merge_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_columns</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="n">merge_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="verificando-dados-duplicados">Verificando dados duplicados 🎌</h3>
<p>O critério que estou seguindo é de validar se a coluna <em>'listing_id'</em> possui dados duplicados, já que ela é a coluna de linha única para o dataset dos imóveis, já no dataset das reviews, esta coluna de <em>'listing_id'</em> pode repetir, a que não pode neste caso é a <em>'review_id'</em></p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">duplicatas</span> <span class="o">=</span> <span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;listing_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">contagem_duplicatas</span> <span class="o">=</span> <span class="n">duplicatas</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">if</span> <span class="n">contagem_duplicatas</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Há </span><span class="si">{</span><span class="n">contagem_duplicatas</span><span class="si">}</span><span class="s2"> dados duplicados na coluna &#39;listing_id&#39;.&quot;</span><span class="p">)</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Não existem dados duplicados na coluna &#39;listing_id&#39;.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition success">
<p class="admonition-title">Resultado</p>
<p>Não existem dados duplicados na coluna 'listing_id'.</p>
</div>
<div class="language-py highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># Reviews ⭐</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">duplicatas</span> <span class="o">=</span> <span class="n">df_rev</span><span class="p">[</span><span class="s1">&#39;review_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="n">contagem_duplicatas</span> <span class="o">=</span> <span class="n">duplicatas</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="k">if</span> <span class="n">contagem_duplicatas</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Há </span><span class="si">{</span><span class="n">contagem_duplicatas</span><span class="si">}</span><span class="s2"> dados duplicados na coluna &#39;review_id&#39;.&quot;</span><span class="p">)</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Não existem dados duplicados na coluna &#39;review_id&#39;.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Atenção</p>
<p>Há 160 dados duplicados na coluna 'review_id'.</p>
</div>
<div class="language-py highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">#Excluindo as linhas duplicadas</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">df_rev</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;review_id&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="ajustando-valores-dos-dados">Ajustando Valores dos Dados 📏</h3>
<p>Embora todas as notas das reviews estão na mesma escala, de 0 a 10 e uma nota geral de 0 a 100, vou mudar a escala delas para ser de 0 a 5, porque esta é a escala que a Airbnb divulga as notas dos imóveis em seu <a href="https://www.airbnb.com.br/">site</a>.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Coluna de 0 a 100</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1"># Colunas de 0 a 10</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="n">rev_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>    <span class="s1">&#39;review_scores_accuracy&#39;</span><span class="p">,</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    <span class="s1">&#39;review_scores_cleanliness&#39;</span><span class="p">,</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>    <span class="s1">&#39;review_scores_checkin&#39;</span><span class="p">,</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>    <span class="s1">&#39;review_scores_communication&#39;</span><span class="p">,</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>    <span class="s1">&#39;review_scores_location&#39;</span><span class="p">,</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>    <span class="s1">&#39;review_scores_value&#39;</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="p">]</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="n">merge_df</span><span class="p">[</span><span class="n">rev_columns</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">merge_df</span><span class="p">[</span><span class="n">rev_columns</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
Outro valor que podemos ver de ajustar é a variável <em>'price'</em>, segundo a descrição em seu dicionário ela é:</p>
<p><em>'Listing price (in each country's currency)'</em></p>
<p>Ou seja, são valores com a moeda local de cada país, se quisermos avaliar os valores, não podemos comparar banana 🍌 com maçã 🍎...</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>count    279712.000000
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>mean        608.792737
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>std        3441.826611
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>min           0.000000
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>25%          75.000000
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>50%         150.000000
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>75%         474.000000
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>max      625216.000000
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>Name: price, dtype: float64
</span></code></pre></div></p>
<p>Ignorando quem anunciou seu imóvel de graça rsrs, temos um valor máximo de 625 mil (dólares, reais, kwanzas?), esses valores são das diárias, então a menos que seja um quarto na ISS, esse valor não é em dólar, mas para solucionar esse problema, podemos listar quais cidades possuímos imóveis anunciados e consequentemente seu país e moeda de origem.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;city&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
</span></code></pre></div>
array(['Paris', 'New York', 'Bangkok', 'Rio de Janeiro', 'Sydney',
       'Istanbul', 'Rome', 'Hong Kong', 'Mexico City', 'Cape Town'],
      dtype=object)</p>
<p>Felizmente temos apenas 10 cidades, então vou aproveitar a viagem e mapear manualmente os países correspondentes, porque essa coluna é útil para um filtro no dashboard.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Dicionário que mapeia cada cidade ao seu país correspondente</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">city_to_country</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    <span class="s1">&#39;Paris&#39;</span><span class="p">:</span> <span class="s1">&#39;France&#39;</span><span class="p">,</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="s1">&#39;United States&#39;</span><span class="p">,</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="s1">&#39;Sydney&#39;</span><span class="p">:</span> <span class="s1">&#39;Australia&#39;</span><span class="p">,</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="s1">&#39;Rome&#39;</span><span class="p">:</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>    <span class="s1">&#39;Rio de Janeiro&#39;</span><span class="p">:</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">,</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>    <span class="s1">&#39;Istanbul&#39;</span><span class="p">:</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">,</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>    <span class="s1">&#39;Mexico City&#39;</span><span class="p">:</span> <span class="s1">&#39;Mexico&#39;</span><span class="p">,</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>    <span class="s1">&#39;Bangkok&#39;</span><span class="p">:</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">,</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    <span class="s1">&#39;Cape Town&#39;</span><span class="p">:</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">,</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;Hong Kong&#39;</span> <span class="c1"># Embora Hong Kong seja uma Região Administrativa Especial da China, defini como um país 💪🏼</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="p">}</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c1"># Função para obter o país com base na cidade</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="k">def</span> <span class="nf">get_country</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>    <span class="k">return</span> <span class="n">city_to_country</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;city&#39;</span><span class="p">],</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="c1"># Criar uma nova coluna &#39;country&#39; com base na cidade</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="n">merge_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_country</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="c1"># novo DataFrame separado para as taxas de câmbio</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="n">exchange_rates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;France&#39;</span><span class="p">,</span> <span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">,</span> <span class="s1">&#39;Mexico&#39;</span><span class="p">,</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">,</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">,</span> <span class="s1">&#39;Hong Kong&#39;</span><span class="p">],</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="p">})</span>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="n">c</span> <span class="o">=</span> <span class="n">CurrencyRates</span><span class="p">()</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="c1"># A taxa de câmbio de EUR para USD está dando um resultado totalmente errado, porém, USD para EUR está correto, então tive que fazer essa correção</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="n">euro_to_usd_rate</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="o">.</span><span class="n">get_rate</span><span class="p">(</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">))</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a><span class="k">def</span> <span class="nf">get_exchange_rate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a>    <span class="n">currency</span> <span class="o">=</span> <span class="n">country_to_currency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">])</span>
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a>    <span class="k">if</span> <span class="n">currency</span> <span class="o">==</span> <span class="s1">&#39;EUR&#39;</span><span class="p">:</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a>        <span class="k">return</span> <span class="n">euro_to_usd_rate</span>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a>    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">get_rate</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">)</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="c1"># Dicionário que mapeia cada país à sua moeda correspondente</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="n">country_to_currency</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a>    <span class="s1">&#39;France&#39;</span><span class="p">:</span> <span class="s1">&#39;EUR&#39;</span><span class="p">,</span>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a>    <span class="s1">&#39;United States&#39;</span><span class="p">:</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>    <span class="s1">&#39;Australia&#39;</span><span class="p">:</span> <span class="s1">&#39;AUD&#39;</span><span class="p">,</span>
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a>    <span class="s1">&#39;Italy&#39;</span><span class="p">:</span> <span class="s1">&#39;EUR&#39;</span><span class="p">,</span>
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a>    <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span> <span class="s1">&#39;BRL&#39;</span><span class="p">,</span>
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a>    <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span> <span class="s1">&#39;TRY&#39;</span><span class="p">,</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a>    <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;MXN&#39;</span><span class="p">,</span>
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a>    <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span> <span class="s1">&#39;THB&#39;</span><span class="p">,</span>
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a>    <span class="s1">&#39;South Africa&#39;</span><span class="p">:</span> <span class="s1">&#39;ZAR&#39;</span><span class="p">,</span>
</span><span id="__span-30-49"><a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a>    <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;HKD&#39;</span><span class="p">,</span>
</span><span id="__span-30-50"><a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a><span class="p">}</span>
</span><span id="__span-30-51"><a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a>
</span><span id="__span-30-52"><a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a><span class="c1"># Nova coluna &#39;exchange_rate&#39; no DataFrame exchange_rates</span>
</span><span id="__span-30-53"><a id="__codelineno-30-53" name="__codelineno-30-53" href="#__codelineno-30-53"></a><span class="n">exchange_rates</span><span class="p">[</span><span class="s1">&#39;exchange_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exchange_rates</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_exchange_rate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-30-54"><a id="__codelineno-30-54" name="__codelineno-30-54" href="#__codelineno-30-54"></a>
</span><span id="__span-30-55"><a id="__codelineno-30-55" name="__codelineno-30-55" href="#__codelineno-30-55"></a><span class="c1"># Merge entre o DataFrame merge_df e o DataFrame exchange_rates usando a coluna &#39;country&#39; como chave</span>
</span><span id="__span-30-56"><a id="__codelineno-30-56" name="__codelineno-30-56" href="#__codelineno-30-56"></a><span class="n">out_df</span> <span class="o">=</span> <span class="n">merge_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">exchange_rates</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</span><span id="__span-30-57"><a id="__codelineno-30-57" name="__codelineno-30-57" href="#__codelineno-30-57"></a>
</span><span id="__span-30-58"><a id="__codelineno-30-58" name="__codelineno-30-58" href="#__codelineno-30-58"></a><span class="c1"># Criar uma nova coluna &#39;price_usd&#39; multiplicando &#39;price&#39; por &#39;exchange_rate&#39;</span>
</span><span id="__span-30-59"><a id="__codelineno-30-59" name="__codelineno-30-59" href="#__codelineno-30-59"></a><span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;exchange_rate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-30-60"><a id="__codelineno-30-60" name="__codelineno-30-60" href="#__codelineno-30-60"></a>
</span><span id="__span-30-61"><a id="__codelineno-30-61" name="__codelineno-30-61" href="#__codelineno-30-61"></a><span class="c1"># O DataFrame out_df agora conterá as colunas &#39;exchange_rate&#39; e &#39;price_usd&#39;</span>
</span><span id="__span-30-62"><a id="__codelineno-30-62" name="__codelineno-30-62" href="#__codelineno-30-62"></a><span class="n">out_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
O nosso arquivo tratado está praticamente pronto, um último ajuste, apenas para uma questão de filtro no dashboard também, vou trocar ou valores da variável <em>'instante_bookable'</em> de 't' e 'f' por um texto:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># Substitua &#39;t&#39; por &#39;Instant Bookable&#39; e &#39;f&#39; por &#39;Schedule Reservation&#39; na coluna &#39;instant_bookable&#39;</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;instant_bookable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;instant_bookable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;Instant Bookable&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;Schedule Reservation&#39;</span><span class="p">})</span>
</span></code></pre></div>
<h3 id="analises-graficas">Análises Gráficas 📈</h3>
<h4 id="grafico-de-distribuicao">Gráfico de Distribuição 📊</h4>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1"># Calcular a média de &#39;price_usd&#39; por país</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">average_prices</span> <span class="o">=</span> <span class="n">out_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c1"># Ordenar o DataFrame pela média de &#39;price_usd&#39; em ordem decrescente</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="n">average_prices</span> <span class="o">=</span> <span class="n">average_prices</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;price_usd&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c1"># Criar um gráfico de barras</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">average_prices</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">],</span> <span class="n">average_prices</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ff5a60&#39;</span><span class="p">)</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;País&#39;</span><span class="p">)</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Média de Preço (USD)&#39;</span><span class="p">)</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Média de Preço (USD) por País&#39;</span><span class="p">)</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="c1"># Exibir o gráfico</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/distribuicao.png" />
Este é um gráfico simples, podemos trazê-lo direto no dashboard e se necessário, incrementá-lo lá, então deixaremos para trazer outros gráficos assim para a parte de criação do dashboard.</p>
<h4 id="grafico-de-dispersao">Gráfico de Dispersão 👨🏽‍👨🏽‍👦🏽‍👧🏽</h4>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># Criar um gráfico de dispersão</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">],</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ff5a60&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlação entre Valor do Imóvel e Nota de Avaliação&#39;</span><span class="p">)</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor do Imóvel&#39;</span><span class="p">)</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Nota da Avaliação&#39;</span><span class="p">)</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="c1"># Exibir o gráfico</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/dispersao.png" />
Usando duas dimensões podemos facilmente ver uma concentração na parte superior esquerda, que indica ótimas avaliações e preço menos, podemos observar um acúmulo de imóveis com nota zero, que entra na questão de imóveis sem avaliação que discutimos anteriormente. Além disso, temos um ponto isolado que custa mais de 120 mil dólares, este ponto é:
<div class="language-py highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;neighbourhood&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;property_type&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews&#39;</span><span class="p">,</span><span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;price_usd&#39;</span><span class="p">]</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">out_df2</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="n">selected_columns</span><span class="p">]</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="n">out_df2</span> <span class="o">=</span> <span class="n">out_df2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;price_usd&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="n">out_df2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>neighbourhood</th>
      <th>city</th>
      <th>country</th>
      <th>property_type</th>
      <th>qty_reviews</th>
      <th>price</th>
      <th>price_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>181027</th>
      <td>Temporary rentals for Brazilian Cup.</td>
      <td>Sao Cristovao</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Shared room in house</td>
      <td>0.0</td>
      <td>625216</td>
      <td>127783.41</td>
    </tr>
    <tr>
      <th>162251</th>
      <td>Hotel Boutique Maison Salamanca</td>
      <td>Cuauhtemoc</td>
      <td>Mexico City</td>
      <td>Mexico</td>
      <td>Room in boutique hotel</td>
      <td>0.0</td>
      <td>499000</td>
      <td>29095.47</td>
    </tr>
    <tr>
      <th>134601</th>
      <td>B&amp;B Linda House - Double bedroom between Copac...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>134562</td>
      <td>27502.16</td>
    </tr>
    <tr>
      <th>44515</th>
      <td>3 quartos Elegante na Av Atlantica com Vista P...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>129233</td>
      <td>26413.01</td>
    </tr>
    <tr>
      <th>245011</th>
      <td>Owesome flat in Botafogo</td>
      <td>Botafogo</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>245787</th>
      <td>Rio Spot Homes T027</td>
      <td>Barra da Tijuca</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>4.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>64485</th>
      <td>Apartamento Alma Carioca | RIO136</td>
      <td>Ipanema</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>3.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>219194</th>
      <td>Amplo apartamento para famílias</td>
      <td>Lagoa</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>235968</th>
      <td>Studio in Botafogo</td>
      <td>Botafogo</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>97.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>239720</th>
      <td>Linda vista com jardim em Santa Teresa</td>
      <td>Santa Teresa</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>33.0</td>
      <td>129080</td>
      <td>26381.74</td>
    </tr>
    <tr>
      <th>137832</th>
      <td>B&amp;B Zul e Verde - Large quadruple room in the ...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>134600</th>
      <td>B&amp;B Peixoto - Double ensuite room in Copacabana</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>134602</th>
      <td>B&amp;B Angela Copa - Double bedroom in Copacabana</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>134599</th>
      <td>B&amp;B Zul e Verde - Large bedroom in the heart o...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>61242</th>
      <td>Apt Claudia Copa</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>137831</th>
      <td>B&amp;B Zul e Verde - Large triple room in the hea...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Private room in bed and breakfast</td>
      <td>0.0</td>
      <td>126233</td>
      <td>25799.86</td>
    </tr>
    <tr>
      <th>244010</th>
      <td>Holiday Rentals for up to 5 people in Copacaba...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>1.0</td>
      <td>112205</td>
      <td>22932.78</td>
    </tr>
    <tr>
      <th>211416</th>
      <td>STIO CANTINHO DAS GARÇAS - GUARATIBA #505</td>
      <td>Guaratiba</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire house</td>
      <td>0.0</td>
      <td>111411</td>
      <td>22770.50</td>
    </tr>
    <tr>
      <th>211419</th>
      <td>Casa no Jardim Botanico #512</td>
      <td>Alto da Boa Vista</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire house</td>
      <td>0.0</td>
      <td>110918</td>
      <td>22669.73</td>
    </tr>
    <tr>
      <th>37652</th>
      <td>Esplendida Cobertura com Vista para o Mar</td>
      <td>Barra da Tijuca</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>1.0</td>
      <td>109281</td>
      <td>22335.16</td>
    </tr>
    <tr>
      <th>98808</th>
      <td>Habitacion a 40min del centro historico</td>
      <td>Iztapalapa</td>
      <td>Mexico City</td>
      <td>Mexico</td>
      <td>Private room in house</td>
      <td>0.0</td>
      <td>350000</td>
      <td>20407.64</td>
    </tr>
    <tr>
      <th>111113</th>
      <td>******Paddington Sydney*****</td>
      <td>Woollahra</td>
      <td>Sydney</td>
      <td>Australia</td>
      <td>Private room in house</td>
      <td>2.0</td>
      <td>28613</td>
      <td>18703.58</td>
    </tr>
    <tr>
      <th>210814</th>
      <td>M/Y ONEWORLD - All-Inclusive Superyacht Charter</td>
      <td>Sydney</td>
      <td>Sydney</td>
      <td>Australia</td>
      <td>Boat</td>
      <td>0.0</td>
      <td>23571</td>
      <td>15407.76</td>
    </tr>
    <tr>
      <th>36228</th>
      <td>Cute 1 bedroom flat in the center of Paris.</td>
      <td>Gobelins</td>
      <td>Paris</td>
      <td>France</td>
      <td>Entire apartment</td>
      <td>2.0</td>
      <td>12000</td>
      <td>13059.08</td>
    </tr>
    <tr>
      <th>60735</th>
      <td>Amazing apartment 10P-St Marcel/Mouffetard MASQ</td>
      <td>Gobelins</td>
      <td>Paris</td>
      <td>France</td>
      <td>Entire apartment</td>
      <td>4.0</td>
      <td>11599</td>
      <td>12622.69</td>
    </tr>
    <tr>
      <th>196424</th>
      <td>Room in the most exclusive area in Mexico City</td>
      <td>Miguel Hidalgo</td>
      <td>Mexico City</td>
      <td>Mexico</td>
      <td>Private room in apartment</td>
      <td>3.0</td>
      <td>206499</td>
      <td>12040.45</td>
    </tr>
    <tr>
      <th>202783</th>
      <td>Entire Palace - 8 Apartments at Piazza Di Spagna</td>
      <td>I Centro Storico</td>
      <td>Rome</td>
      <td>Italy</td>
      <td>Entire condominium</td>
      <td>0.0</td>
      <td>10571</td>
      <td>11503.96</td>
    </tr>
    <tr>
      <th>204377</th>
      <td>Ocean View Villa with Pool in Joa - ilive010</td>
      <td>Sao Conrado</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire villa</td>
      <td>0.0</td>
      <td>55978</td>
      <td>11440.94</td>
    </tr>
    <tr>
      <th>222758</th>
      <td>COZY AND CONFORTABLE 2BDR - LB1-0022</td>
      <td>Leblon</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>55489</td>
      <td>11341.00</td>
    </tr>
    <tr>
      <th>44312</th>
      <td>COPACABANA RIO - Beautiful Beachfront 4 -BDR #...</td>
      <td>Copacabana</td>
      <td>Rio de Janeiro</td>
      <td>Brazil</td>
      <td>Entire apartment</td>
      <td>0.0</td>
      <td>55311</td>
      <td>11304.62</td>
    </tr>
  </tbody>
</table>
</div>

<p><em>'Temporary rentals for Brazilian Cup'</em> no Rio de Janeiro, acho improvável um imóvel ter este valor de diária mesmo em uma data especial como a de uma Copa do Mundo, além disso, foi por causa deste imóvel que a média dos imóveis do Brasil foi a mais alta entre todos os países, sendo uma surpresa para 0 pessoas que ele não foi alugado nenhuma vez, até porquê, é 120 mil em um quarto compartilhado kkrying 🤣</p>
<p>Além do fato dele ser um imóvel anunciado como um aluguel temporário por causa da Copa do Mundo e ela já passou... Vou remover este dado do dataset.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">out_df</span> <span class="o">=</span> <span class="n">out_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">181027</span><span class="p">)</span>
</span></code></pre></div>
Desconsiderando este imóvel que acabamos de excluir, os outros imóveis também possuem um valor bem alto, um gráfico que é bom para identificação desses possíveis outliers é o boxplot:</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;price_usd&#39;</span><span class="p">)</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribuição de Preços por País&#39;</span><span class="p">)</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/boxplot.png" /></p>
<p>Entramos no <a href="https://chat.openai.com/share/9f8a8820-1028-4d27-a055-3200ca0e71d2">dilema dos outliers</a>. </p>
<div class="admonition question">
<p class="admonition-title">Pergunta</p>
<p>Poderíamos simplesmente remover esses pontos isolados para ter valores, como médias, mais coerentes com nossos dados reais?</p>
</div>
<p>Eu não sou especialista neste assunto de imóveis, então o que me restou foi realizar um cornojob, onde pesquisei no próprio site da Airbnb imóveis nestes locais com filtros para obter os maiores valores, inclusive, faltou um 'Filtrar por maior preço' no site, em alguns casos eu tive que editar o valor direto na URL para filtrar.</p>
<ul>
<li><a href="https://www.airbnb.com/s/Rio-de-Janeiro--Rio-de-Janeiro--Brazil/homes?adults=2&amp;tab_id=home_tab&amp;refinement_paths%5B%5D=%2Fhomes&amp;flexible_trip_lengths%5B%5D=one_week&amp;monthly_start_date=2023-11-01&amp;monthly_length=3&amp;price_filter_input_type=2&amp;price_filter_num_nights=5&amp;channel=EXPLORE&amp;search_type=autocomplete_click&amp;date_picker_type=calendar&amp;source=structured_search_input_header&amp;price_min=18000&amp;query=Rio%20de%20Janeiro%2C%20RJ&amp;place_id=ChIJW6AIkVXemwARTtIvZ2xC3FA">Rio de Janeiro</a></li>
<li><a href="https://www.airbnb.com/s/Paddington-Sydney/homes?adults=2&amp;tab_id=home_tab&amp;refinement_paths%5B%5D=%2Fhomes&amp;flexible_trip_lengths%5B%5D=one_week&amp;monthly_start_date=2023-11-01&amp;monthly_length=3&amp;price_filter_input_type=2&amp;price_filter_num_nights=5&amp;channel=EXPLORE&amp;search_type=filter_change&amp;date_picker_type=calendar&amp;source=structured_search_input_header&amp;query=Paddington%20NSW%2C%20Australia&amp;place_id=ChIJt4nzrAiuEmsRcMUyFmh9AQU&amp;price_min=2478&amp;tier_ids%5B%5D=2">Austrália</a></li>
<li><a href="https://www.airbnb.com/s/Mexico-City--Mexico-City--Mexico/homes?adults=2&amp;tab_id=home_tab&amp;refinement_paths%5B%5D=%2Fhomes&amp;flexible_trip_lengths%5B%5D=one_week&amp;monthly_start_date=2023-11-01&amp;monthly_length=3&amp;price_filter_input_type=2&amp;price_filter_num_nights=5&amp;channel=EXPLORE&amp;search_type=filter_change&amp;date_picker_type=calendar&amp;source=structured_search_input_header&amp;price_min=18000&amp;query=Mexico%20City%2C%20Mexico%20City%2C%20Mexico&amp;place_id=ChIJB3UJ2yYAzoURQeheJnYQBlQ&amp;federated_search_session_id=5cc6ea3e-4781-4ae9-b33f-a6ccf08c2690&amp;pagination_search=true&amp;cursor=eyJzZWN0aW9uX29mZnNldCI6MCwiaXRlbXNfb2Zmc2V0IjowLCJ2ZXJzaW9uIjoxfQ%3D%3D">Cidade do México</a></li>
</ul>
<p>Em todos os casos existe imóveis de alto padrão correspondentes aos preços altos encontrados no dataset, então aqueles valores que por mais que sejam muito altos, são reais.</p>
<div class="admonition sucess">
<p class="admonition-title">Decisão:</p>
<p>Vou manter todos esses dados, posso na etapa do dashboard criar uma label para filtrar e excluir esses valores da visualização dos dados, para quando for pertinenete.</p>
</div>
<div class="admonition quote">
<p>'Ah! mas você já removeu aquela linha que tinha um quarto compartilhado de 120 mil dólares no RJ'</p>
</div>
<p>Bem, já havia dito o quão rídiculo era aquele caso, pelo próprio dataset era possível saber que não se tratava de um imóvel luxuoso, mas como desencargo de consciência, eu também realizei uma pesquisa com imóveis no RJ por mais de 100k dólares e só achei outros belos e majestosos imóveis como o que excluí, o melhor que desta vez tem fotos, vale a pena conferir:</p>
<p><a href="https://www.airbnb.com/s/Rio-de-Janeiro--Rio-de-Janeiro--Brazil/homes?adults=2&amp;tab_id=home_tab&amp;refinement_paths[]=%2Fhomes&amp;flexible_trip_lengths[]=one_week&amp;monthly_start_date=2023-11-01&amp;monthly_length=3&amp;price_filter_input_type=2&amp;price_filter_num_nights=5&amp;channel=EXPLORE&amp;search_type=autocomplete_click&amp;date_picker_type=calendar&amp;source=structured_search_input_header&amp;price_min=100000&amp;query=Rio%20de%20Janeiro%2C%20RJ&amp;place_id=ChIJW6AIkVXemwARTtIvZ2xC3FA">Rio de Janeiro +100k USD</a></p>
<p>Vamos voltar ao nosso gráfico de dispersão, agora sem aquele outlier, os pontos que estavam achatados na esquerda serão melhores distribuídos.
Também vamos aproveitar e incrementar o gráfico, adicionando mais um eixo nele, plotando assim um gráfico em 3D, com:</p>
<ul>
<li>Valor do imóvel</li>
<li>Review do imóvel</li>
<li>Quantidade de review </li>
</ul>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1"># Criar um gráfico tridimensional</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">]</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="n">y</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">]</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="n">z</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="c1"># Scatter plot tridimensional</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#ff5a60&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;price_usd&#39;</span><span class="p">)</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">)</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Popularidade (qrt_reviews)&#39;</span><span class="p">)</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relação entre Valor do Imóvel, Nota de Avaliação e Popularidade&#39;</span><span class="p">)</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="c1"># Exibir o gráfico tridimensional</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/distribuicao2.png" />
Com este gráfico atual a gente separou o joio do trigo 🌾.
Antes um imóvel com alto valor poderia receber 1 ou 2 feedbacks e ficar bem posicionado, usando a quantidade de reviews sabemos quais são de fato os mais populares e lucrativos.
Se você tem dificuldade em enxergar em um mapa de 3 dimensões, neste gráfico a melhor posição é para frente, onde as revies tendem a 5, para cima, onde a popularidade (etiqueta cortada), está tendendo a 800 e por fim, onde o preço está para direta, chegando até 30 mil.</p>
<p>Conseguiu entender? Bom! Então vamos complicar mais um pouco... Podemos agrupor por instant_bookable, essa variável basicamente determina o que pode ser alugado de imediato e o que não pode.
Casas sem hospedeiros podem ser alugadas instantaneamente, já as casas que estão alugadas, precisam ser reservadas para o final do contrato atual.</p>
<p>Então mesmo ocupando uma ótima posição no gráfico, se a casa está disponível, é sinal que dinheiro por ela não tá entrando no caixa.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Instant Bookable&#39;</span><span class="p">:</span> <span class="s1">&#39;#ff5a60&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Reservation&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">colors</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;instant_bookable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">color_map</span><span class="p">)</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="c1"># Criar um gráfico tridimensional</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="n">x</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">]</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="n">y</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">]</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="n">z</span> <span class="o">=</span> <span class="n">out_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="c1"># Scatter plot tridimensional</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;price_usd&#39;</span><span class="p">)</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;review_scores_rating&#39;</span><span class="p">)</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Popularidade (qty_reviews)&#39;</span><span class="p">)</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="c1"># Adicionar legenda</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Instant Bookable&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;#ff5a60&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>                   <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Schedule Reservation&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)]</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">)</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a>
</span><span id="__span-38-26"><a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relação entre Valor do Imóvel, Nota de Avaliação e Popularidade (agrupado por instant_bookable)&#39;</span><span class="p">)</span>
</span><span id="__span-38-27"><a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a>
</span><span id="__span-38-28"><a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a><span class="c1"># Exibir o gráfico tridimensional</span>
</span><span id="__span-38-29"><a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/distribuicao3.png" /></p>
<h4 id="mapa-de-calor">Mapa de Calor 🔥🗺️</h4>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="c1"># Selecionar as colunas numéricas</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">out_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="c1"># Calcular a matriz de correlação</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">numeric_columns</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="c1"># Criar um mapa de calor</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">)</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mapa de Calor das Variáveis&#39;</span><span class="p">)</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<img alt="Alt text" src="../img/mapa.png" />
Tirando as correlações óbvias, como notas das reviews que são correlacionadas, assim como o valor da moeda e seu respectivo valor convertido em dólar e afins, não achei nenhum ponto muito interessante, mas este heatmap é apenas das variáveis numéricas, vamos finalizar a exploração em Python e continuar em nosso dashboard.</p>
<h3 id="definindo-um-score">Definindo um Score 🥇</h3>
<p>Conforme vimos no <a href="#2">gráfico de dispersão</a>, quando trazemos uma contextualização da situação de negócio para os dados analisados, observar uma váriavel isolada, duas ou mais, pode não ser o suficiente e o pior, elas podem nos levar a cometer erros em nossas decisões, o gráfico de dispersão em 3D que montamos ele ajuda muito a entendermos como aquelas 3 variáveis se comportam para a definição dos melhores imóveis, porém, se a leitura dele pode ser difícil até para um analista fazer de bate e pronto, então imagina para uma diretoria...</p>
<p>Então para o dashboard a minha ideia e traduzir aquele gráfico em uma tabela, que simplesmente traga um 'Top 5 Melhores Imóveis' e para isso, eu vou criar um sistema de pontuação que relacione essas 3 váriaveis.</p>
<div class="admonition danger">
<p class="admonition-title">Ponto de Atenção</p>
<p>Não podemos simplesmente relacionar um valor com o outro diretamente, que diferente de um gráfico, não teremos eixos distintos, trabalharemos em um único plano, então o valor do imóvel tem muito mais dígitos que comparado as notas que vão até o número 5.</p>
</div>
<div class="admonition success">
<p class="admonition-title">Solução:</p>
<p>Normalizar os dados.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Ponto de Atenção</p>
<p>As 3 variáveis tendo a mesma proporção traz uma nova questão, uma variável é mais importante que outra para caráter de decisão?  </p>
</div>
<div class="admonition success">
<p class="admonition-title">Solução:</p>
<p>Criação arbitrária de pesos, para dosar cada variável.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Fórmula:</p>
<p>Score = (Peso_Preço * Preço) + (Peso_Nota * Nota) + (Peso_Qty_Review * Qty_Review)</p>
</div>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1"># Defição dos pesos para cada variável</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="n">peso_preco</span> <span class="o">=</span> <span class="mf">0.4</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="n">peso_nota</span> <span class="o">=</span> <span class="mf">0.2</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="n">peso_reviews</span> <span class="o">=</span> <span class="mf">0.4</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="c1"># Esses valores podem ser alterados, mas a soma de todos precisa resutar em 1</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c1"># Vamos criar um novo DF copiando o DF original</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="n">score_df</span> <span class="o">=</span> <span class="n">out_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="c1"># Normalizando as colunas &#39;price_usd&#39;, &#39;review_scores_rating&#39; e &#39;qty_reviews&#39;</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="c1"># Essas colunas são auxiliares, então após o cálculo da pontuação, podemos excluí-las</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="n">score_df</span><span class="p">[[</span><span class="s1">&#39;price_usd_normalized&#39;</span><span class="p">,</span> <span class="s1">&#39;review_scores_rating_normalized&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews_normalized&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">out_df</span><span class="p">[[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">,</span> <span class="s1">&#39;review_scores_rating&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews&#39;</span><span class="p">]])</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="c1"># Calcular a pontuação usando a fórmula</span>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">peso_preco</span> <span class="o">*</span> <span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;price_usd_normalized&#39;</span><span class="p">]</span> <span class="o">+</span>
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a>                             <span class="n">peso_nota</span> <span class="o">*</span> <span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;review_scores_rating_normalized&#39;</span><span class="p">]</span> <span class="o">+</span>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>                             <span class="n">peso_reviews</span> <span class="o">*</span> <span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews_normalized&#39;</span><span class="p">])</span>
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="c1"># Excluindo as colunas normalizadas</span>
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="n">score_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;price_usd_normalized&#39;</span><span class="p">,</span> <span class="s1">&#39;review_scores_rating_normalized&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews_normalized&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-40-24"><a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a>
</span><span id="__span-40-25"><a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="c1"># Ordenando o DataFrame pela pontuação em ordem decrescente</span>
</span><span id="__span-40-26"><a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a><span class="n">score_df</span> <span class="o">=</span> <span class="n">score_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-40-27"><a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a>
</span><span id="__span-40-28"><a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a><span class="n">score_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
Vamos agora dar uma analisada neste Top 5.</p>
<p>Embora tenhamos preços muito altos no topo, também temos em algumas posições valores bem baixos, vamos multiplicá-los pela quantidade de reviews, na ideia que isso proporcionalmente indique a quantidade de clientes destes imóveis e assim, termos um valor arrecadado total com o imóvel.</p>
<div class="admonition info">
<p class="admonition-title">Detalhe:</p>
<p>Esse valor arrecadado não é o valor absoluto arrecadado, porque muitas pessoas alugam os imóveis e não enviam review, este é um valor tendo base apenas a quantidade de pessoas que sabemos devido as reviews.</p>
</div>
<div class="language-py highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">novo_df</span> <span class="o">=</span> <span class="n">score_df</span><span class="p">[[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">,</span> <span class="s1">&#39;review_scores_rating&#39;</span><span class="p">,</span> <span class="s1">&#39;qty_reviews&#39;</span><span class="p">,</span><span class="s1">&#39;Score&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="n">novo_df</span><span class="p">[</span><span class="s1">&#39;price_accumulated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;price_usd&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">score_df</span><span class="p">[</span><span class="s1">&#39;qty_reviews&#39;</span><span class="p">]</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="n">novo_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_usd</th>
      <th>review_scores_rating</th>
      <th>qty_reviews</th>
      <th>Score</th>
      <th>price_accumulated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>235968</th>
      <td>26381.74</td>
      <td>4.75</td>
      <td>97.0</td>
      <td>0.596239</td>
      <td>2559028.78</td>
    </tr>
    <tr>
      <th>167067</th>
      <td>82.71</td>
      <td>4.70</td>
      <td>891.0</td>
      <td>0.589137</td>
      <td>73694.61</td>
    </tr>
    <tr>
      <th>131663</th>
      <td>80.44</td>
      <td>4.80</td>
      <td>828.0</td>
      <td>0.564823</td>
      <td>66604.32</td>
    </tr>
    <tr>
      <th>239720</th>
      <td>26381.74</td>
      <td>4.65</td>
      <td>33.0</td>
      <td>0.563507</td>
      <td>870597.42</td>
    </tr>
    <tr>
      <th>178743</th>
      <td>9357.35</td>
      <td>4.75</td>
      <td>526.0</td>
      <td>0.554783</td>
      <td>4921966.10</td>
    </tr>
  </tbody>
</table>
</div>

<p>Mesmo o preço acumulado dos imóveis de 80 dólares sendo inferior ao #4 e #5, ainda veja como merecido a posição deles, aquele número alto de reviews com mais de 800 me diz mais sobre o sucesso daqueles imóveis do que o que teve 33 reviews.</p>
<p>Eu testei várias proporções de pesos, mas a que achei mais interessante foi a relação de 80% do pseudo preço acumulado + 20% de ponderação pela nota geral das reviews.</p>
<p>Você pode testar outras, no dashboard teremos a tabela dos melhores, junto com o ID do imóvel, assim bou fazer outro gráfico que seja possível acompanhar a quantidade de reviews históricas de um imóvel em específico, trazendo ainda mais contexto para o nosso sistema de pontuação.</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1"># Extrair a coluna &#39;host_location&#39;</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="n">coluna_host_location</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;host_location&#39;</span><span class="p">]</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="c1"># Criar um novo DataFrame apenas com a coluna &#39;host_location&#39;</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="n">novo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;host_location&#39;</span><span class="p">:</span> <span class="n">coluna_host_location</span><span class="p">})</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="c1"># Salvar o novo DataFrame em um arquivo Excel</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="n">novo_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;host_location.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span>
</span></code></pre></div>
Antes de sair eu baixei esta coluna só para dar uma analisada no Excel mesmo, tenho 2 pontos para ela:</p>
<ul>
<li>Incluir lista suspensa para validação de dados para a localização;</li>
<li>Resolver o problema de 2 ou mais países cadastrados em um único registro.</li>
</ul>
<p>Essa coluna foi excluída da nossa base final, mas pensando como um profissional da companhia, este ponto não poderia ser negligenciado, assim como tornar obrigatórios alguns campos como a quantidade de quartos.</p>
<h2 id="salvando-os-resultados">Salvando os Resultados 💾</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;Listings_output.csv&#39;</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="c1"># Salve o DataFrame como um arquivo CSV com codificação UTF-8</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="n">score_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O arquivo </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> foi salvo com sucesso.&#39;</span><span class="p">)</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;Reviews_output.csv&#39;</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="c1"># Salve o DataFrame como um arquivo CSV com codificação UTF-8</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="n">df_rev</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;O arquivo </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> foi salvo com sucesso.&#39;</span><span class="p">)</span>
</span></code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.tabs", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>